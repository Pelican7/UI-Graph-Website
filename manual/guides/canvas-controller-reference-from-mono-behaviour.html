<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html>
  
  <head>
  
  	<!-- Google Analytics -->
  	<script>
  		(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  		(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  		m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  		})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  
  		ga('create', 'UA-57773606-5', 'auto');
  		ga('send', 'pageview');
  	</script>
  	<!-- End Google Analytics -->
  
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Referencing A Canvas Controller From Its View Components </title>
    <meta name="viewport" content="width=device-width">
    <meta name="title" content="Referencing A Canvas Controller From Its View Components ">
    <meta name="generator" content="docfx 2.44.0.0">
    
    <link rel="shortcut icon" href="../../images/favicon.ico">
    <link rel="stylesheet" href="../../styles/docfx.vendor.css">
    <link rel="stylesheet" href="../../styles/docfx.css">
    <link rel="stylesheet" href="../../styles/main.css">
    <meta property="docfx:navrel" content="../../toc.html">
    <meta property="docfx:tocrel" content="../toc.html">
    
    
    <meta property="docfx:newtab" content="true">
  </head>
  <body data-spy="scroll" data-target="#affix" data-offset="120">
    <div id="wrapper">
      <header>
        
        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
              
              <a class="navbar-brand" href="../../index.html">
                <img id="logo" class="svg" src="../../images/appLogo.svg" alt="">
              </a>
            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>
            </div>
          </div>
        </nav>
        
        <div class="subnav navbar navbar-default">
          <div class="container hide-when-search" id="breadcrumb">
            <ul class="breadcrumb">
              <li></li>
            </ul>
          </div>
        </div>
      </header>
      <div role="main" class="container body-content hide-when-search">
        
        <div class="sidenav hide-when-search">
          <a class="btn toc-toggle collapse" data-toggle="collapse" href="#sidetoggle" aria-expanded="false" aria-controls="sidetoggle">Show / Hide Table of Contents</a>
          <div class="sidetoggle collapse" id="sidetoggle">
            <div id="sidetoc"></div>
          </div>
        </div>
        <div class="article row grid-right">
          <div class="col-md-10">
            <article class="content wrap" id="_content" data-uid="canvas-controller-reference-from-mono-behaviour">
<h1 id="referencing-a-canvas-controller-from-its-view-components">Referencing A Canvas Controller From Its View Components</h1>

<p>It is sometimes required that scripts within a canvas controller&#39;s view prefab obtain a reference to their owning canvas controller. For example, we might want to trigger a <a class="xref" href="../graphs/graphs.html#manual-transitions">manual transition</a> on the canvas controller after a time delay. Perhaps something like this:</p>
<pre><code class="lang-csharp">public float delay;
public string transitionIdentifier;

private float elapsedTime;

private void Update()
{
    // Wait for the required time.
    elapsedTime += Time.deltaTime;
    if (elapsedTime &gt;= delay)
    {
        // Perform the transition when the required time has elapsed.
        PerformGraphTransitionWithIdentifier(transitionIdentifier, this);
    }
}
</code></pre><p>However, if you were to add this code to a <a class="xref" href="../../api/Pelican7.UIGraph.CanvasController.html">CanvasController</a> script, you would find that the <code>Update</code> method is never called. This is because canvas controllers are <a href="https://docs.unity3d.com/ScriptReference/ScriptableObject.html">ScriptableObjects</a>, not <a href="https://docs.unity3d.com/ScriptReference/MonoBehaviour.html">MonoBehaviours</a>, and they therefore do not have an <code>Update</code> method as <code>MonoBehaviour</code> does.</p>
<p>The solution then, is to place the above code in a <code>MonoBehaviour</code> script, <code>PerformTransitionAfterDelay</code>, and add it to a game object in our canvas controller&#39;s view prefab.</p>
<pre><code class="lang-csharp">public class PerformTransitionAfterDelay : MonoBehaviour
{
    public float delay;
    public string transitionIdentifier;

    private float elapsedTime;

    private void Update()
    {
        // Wait for the required time.
        elapsedTime += Time.deltaTime;
        if (elapsedTime &gt;= delay)
        {
            // Perform the transition when the required time has elapsed.
            PerformGraphTransitionWithIdentifier(transitionIdentifier, this); // &lt;-- Error
            enabled = false;
        }
    }
}
</code></pre><p>This, however, poses a second problem - the call to <a class="xref" href="../../api/Pelican7.UIGraph.ViewController-12.html#Pelican7_UIGraph_ViewController_12_PerformGraphTransitionWithIdentifier_">PerformGraphTransitionWithIdentifier</a>. <a class="xref" href="../../api/Pelican7.UIGraph.ViewController-12.html#Pelican7_UIGraph_ViewController_12_PerformGraphTransitionWithIdentifier_">PerformGraphTransitionWithIdentifier</a> is a method on the <a class="xref" href="../../api/Pelican7.UIGraph.CanvasController.html">CanvasController</a> class, and now that we are no longer within our <a class="xref" href="../../api/Pelican7.UIGraph.CanvasController.html">CanvasController</a> script, we need to obtain a reference to the canvas controller in order to invoke <a class="xref" href="../../api/Pelican7.UIGraph.ViewController-12.html#Pelican7_UIGraph_ViewController_12_PerformGraphTransitionWithIdentifier_">PerformGraphTransitionWithIdentifier</a> on it.</p>
<h2 id="canvas-view-owner-bindings">Canvas View Owner Bindings</h2>
<p>Any script within a canvas controller&#39;s view prefab can obtain a reference to the owning canvas controller by using the <strong>Canvas View Owner Bindings</strong> object available in the view hierarchy - specifically its <a class="xref" href="../view-controllers/ui-canvas/canvas-controllers.html#on-bound-to-owner-event">On Bound To Owner</a> event.</p>
<p>When a canvas controller instantiates its view prefab, the view is bound to its owning canvas controller. This binding process binds the view references and callbacks to the canvas controller whom loaded it - its owner. Upon completion this process invokes the <code>OnBoundToOwner</code> event, passing the owning canvas controller to allow any components in the view (view objects) to also bind accordingly.</p>
<div class="NOTE"><h5>Note</h5><p>This binding process occurs before the canvas controller&#39;s <a class="xref" href="../../api/Pelican7.UIGraph.ViewController-12.html#Pelican7_UIGraph_ViewController_12_ViewDidLoad_">ViewDidLoad</a> method is invoked, and before any <code>MonoBehaviours</code> have their <code>Start</code> method called.</p>
</div>
<h2 id="on-bound-to-owner">On Bound To Owner</h2>
<p>Looking at the <strong>Canvas View Owner Bindings</strong>&#39; <a class="xref" href="../../api/Pelican7.UIGraph.CanvasViewOwnerBindings.html#Pelican7_UIGraph_CanvasViewOwnerBindings_OnBoundToOwner">OnBoundToOwner</a> event definition, we can see that the event passes a single <a class="xref" href="../../api/Pelican7.UIGraph.CanvasController.html">CanvasController</a> argument - the owner. We can therefore add a public method to our <code>MonoBehaviour</code> script, called <code>Configure</code>, that takes a single <a class="xref" href="../../api/Pelican7.UIGraph.CanvasController.html">CanvasController</a> argument. In this method we will store the owning canvas controller, allowing us to later call <a class="xref" href="../../api/Pelican7.UIGraph.ViewController-12.html#Pelican7_UIGraph_ViewController_12_PerformGraphTransitionWithIdentifier_">PerformGraphTransitionWithIdentifier</a> on it, once the required time has elapsed.</p>
<pre><code class="lang-csharp">public class PerformTransitionAfterDelay : MonoBehaviour
{
    // Specify the amount of time to wait in the inspector.
    public float delay;
    // Specify the transition identifier to invoke in the inspector.
    public string transitionIdentifier;

    private CanvasController canvasController;
    private float elapsedTime;

    // Add this method to the Canvas View Owner Bindings&#39; On Bound To Owner event.
    public void Configure(CanvasController canvasController)
    {
        this.canvasController = canvasController;
    }

    private void Update()
    {
        // Wait for the required time.
        elapsedTime += Time.deltaTime;
        if (elapsedTime &gt;= delay)
        {
            // Perform the transition when the required time has elapsed.
            canvasController.PerformGraphTransitionWithIdentifier(transitionIdentifier, this);
            enabled = false;
        }
    }
}
</code></pre><p>Now all that is left is to connect our script to the <a class="xref" href="../../api/Pelican7.UIGraph.CanvasViewOwnerBindings.html#Pelican7_UIGraph_CanvasViewOwnerBindings_OnBoundToOwner">OnBoundToOwner</a> event in the inspector.</p>
<p><img src="../../images/manual/guides/canvas-controller-reference-from-mono-behaviour/cc-ref-connect.png" alt=""></p>
<h2 id="conclusion">Conclusion</h2>
<p>And that&#39;s it. Our <code>PerformTransitionAfterDelay</code> <code>MonoBehaviour</code>, which is placed in the canvas controller&#39;s view prefab, will now be configured with the owning canvas controller upon load. After the specified time has elapsed, the identified transition will be triggered on the owning canvas controller.</p>
<p>This technique can be used for much more than just triggering a transition after a time delay. You could create a <code>MonoBehaviour</code> to listen to game events or accelerometer changes, to name a few ideas. The key insight is the use of the <strong>Canvas View Owner Bindings</strong>&#39; <em>On Bound To Owner</em> event for obtaining a reference to the owning canvas controller in view scripts.</p>
</article>
          </div>
          
          <div class="hidden-sm col-md-2" role="complementary">
            <div class="sideaffix">
              <div class="contribution">
                <ul class="nav">
                </ul>
              </div>
              <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
              <!-- <p><a class="back-to-top" href="#top">Back to top</a><p> -->
              </nav>
            </div>
          </div>
        </div>
      </div>
      
      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
            
            <span>&copy; 2019 Pelican 7 LTD. All rights reserved.</span>
          </div>
        </div>
      </footer>
    </div>
    
    <script type="text/javascript" src="../../styles/docfx.vendor.js"></script>
    <script type="text/javascript" src="../../styles/docfx.js"></script>
    <script type="text/javascript" src="../../styles/main.js"></script>
  </body>
</html>
